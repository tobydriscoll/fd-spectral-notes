
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6.5. Barycentric formula &#8212; FD and Spectral methods for PDE</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"float": ["\\mathbb{F}"], "real": ["\\mathbb{R}"], "complex": ["\\mathbb{C}"], "nat": ["\\mathbb{N}"], "integer": ["\\mathbb{Z}"], "bfa": "\\mathbf{a}", "bfb": "\\mathbf{b}", "bfd": "\\mathbf{d}", "bfe": "\\mathbf{e}", "bff": "\\mathbf{f}", "bfx": "\\mathbf{x}", "bfX": "\\mathbf{X}", "bfA": "\\mathbf{A}", "bfB": "\\mathbf{B}", "bfJ": "\\mathbf{J}", "bfD": "\\mathbf{D}", "bfE": "\\mathbf{E}", "bfI": "\\mathbf{I}", "bfC": "\\mathbf{C}", "bfF": "\\mathbf{F}", "bfP": "\\mathbf{P}", "bfQ": "\\mathbf{Q}", "bfS": "\\mathbf{S}", "bfW": "\\mathbf{W}", "bfU": "\\mathbf{U}", "bfp": "\\mathbf{p}", "bfs": "\\mathbf{s}", "bfu": "\\mathbf{u}", "bfv": "\\mathbf{v}", "bfw": "\\mathbf{w}", "bfy": "\\mathbf{y}", "bfz": "\\mathbf{z}", "bfzero": "\\boldsymbol{0}", "bfmu": "\\boldsymbol{\\mu}", "bftau": "\\boldsymbol{\\tau}", "TP": "\\text{TP}", "TN": "\\text{TN}", "FP": "\\text{FP}", "FN": "\\text{FN}", "rmn": ["\\mathbb{R}^{#1 \\times #2}", 2], "dd": ["\\frac{d #1}{d #2}", 2], "pp": ["\\frac{\\partial #1}{\\partial #2}", 2], "norm": ["\\left\\lVert \\mathstrut #1 \\right\\rVert", 1], "abs": ["\\left\\lvert \\mathstrut #1 \\right\\rvert", 1], "twonorm": ["\\norm{#1}_2", 1], "onenorm": ["\\norm{#1}_1", 1], "infnorm": ["\\norm{#1}_\\infty", 1], "inprod": ["\\langle #1,#2 \\rangle", 2], "pr": ["^{(#1)}", 1], "diag": ["\\operatorname{diag}"], "diagm": ["\\operatorname{diagm}"], "sign": ["\\operatorname{sign}"], "mtx": ["\\operatorname{mtx}"], "dist": ["\\operatorname{dist}"], "myvec": ["\\operatorname{vec}"], "simil": ["\\operatorname{sim}"], "ee": ["\\times 10^"], "floor": ["\\lfloor#1\\rfloor", 1], "argmin": ["\\operatorname{argmin}"], "epsm": ["\\epsilon_{\\text{mach}}"], "logit": ["\\operatorname{logit}"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.6. Potential theory" href="potential.html" />
    <link rel="prev" title="6.4. Convergence rates" href="smoothness.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">FD and Spectral methods for PDE</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Finite differences and spectral methods for PDEs
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../finite-diffs/overview.html">
   1. Finite differences
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../finite-diffs/integration.html">
     1.1. Indefinite integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../finite-diffs/series.html">
     1.2. Power series and finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../finite-diffs/roundoff.html">
     1.3. Roundoff error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../finite-diffs/fourier.html">
     1.4. Fourier analysis of finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../finite-diffs/interpolation.html">
     1.5. Interpolation and finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../finite-diffs/diffmats.html">
     1.6. Differentiation matrices
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tpbvp/overview.html">
   2. TPBVP
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tpbvp/linear.html">
     2.1. Two-point boundary-value problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tpbvp/bc.html">
     2.2. Boundary conditions for the TPBVP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tpbvp/nonlinear.html">
     2.3. Nonlinear TPBVP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tpbvp/layers.html">
     2.4. Resolving layers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tpbvp/bootstrap.html">
     2.5. Bootstrapping methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../elliptic/overview.html">
   3. Elliptic PDE
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../elliptic/tensorproduct.html">
     3.1. Tensor-product grids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elliptic/poisson.html">
     3.2. Solving the Poisson equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elliptic/disk.html">
     3.3. Discretizing the disk
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elliptic/iterative.html">
     3.4. Iterative linear algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../elliptic/decomp.html">
     3.5. Domain decomposition
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../mol/overview.html">
   4. Method of lines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../mol/ivp.html">
     4.1. Multistep and RK methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mol/stability.html">
     4.2. Absolute stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mol/semidiscretization.html">
     4.3. Semidiscretization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mol/theory.html">
     4.4. Convergence theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mol/beyond.html">
     4.5. Beyond the basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mol/multidim.html">
     4.6. Multiple space dimensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../advection/overview.html">
   5. Advection
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/cfl.html">
     5.1. The CFL condition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/advection_fourier.html">
     5.2. von Neumann analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/groupvel.html">
     5.3. Group velocity and dispersion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/boundaries.html">
     5.4. Boundaries and interfaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/systems.html">
     5.5. Hyperbolic systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="overview.html">
   6. Spectral methods
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="unbounded.html">
     6.1. Unbounded finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sft.html">
     6.2. Unbounded spectral
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dft.html">
     6.3. Periodic discrete functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="smoothness.html">
     6.4. Convergence rates
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.5. Barycentric formula
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="potential.html">
     6.6. Potential theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chebdm.html">
     6.7. Chebyshev differentiation matrix
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chebbvp.html">
     6.8. Chebyshev for BVPs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chebfft.html">
     6.9. Chebyshev and the FFT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigen.html">
     6.10. Eigenvalues
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="timestability.html">
     6.11. Time stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="disk.html">
     6.12. Polar coordinates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration.html">
     6.13. Spectral integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bc.html">
     6.14. Boundary conditions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="uxxxx.html">
     6.16. Fourth-order PDEs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../etc/overview.html">
   7. Advanced
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../etc/splitting.html">
     7.1. Operator splitting
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/tobydriscoll/fd-spectral-notes/main?urlpath=tree/smim/barycentric.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/smim/barycentric.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/smim/barycentric.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#derivation">
   Derivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#runge-phenomenon">
   Runge phenomenon
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chebyshev-points">
   Chebyshev points
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p9-polynomial-interpolation-in-equispaced-and-chebyshev-pts">
     p9: polynomial interpolation in equispaced and Chebyshev pts
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Barycentric formula</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#derivation">
   Derivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#runge-phenomenon">
   Runge phenomenon
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chebyshev-points">
   Chebyshev points
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p9-polynomial-interpolation-in-equispaced-and-chebyshev-pts">
     p9: polynomial interpolation in equispaced and Chebyshev pts
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="barycentric-formula">
<h1><span class="section-number">6.5. </span>Barycentric formula<a class="headerlink" href="#barycentric-formula" title="Permalink to this headline">#</a></h1>
<p>When we want to approximate a function on a bounded interval without the benefit of periodicity, the game changes. Attempting to extend the function periodically does permit using Fourier methods, but they will be subject to the Gibbs phenomenon and converge poorly, if at all.</p>
<p>It seems more reasonable instead to interpolate by a polynomial, which makes no assumption about periodicity. It turns out that there are issues of both selecting a well-conditioned polynomial and of evaluating it stably. We begin with the second of these issues.</p>
<section id="derivation">
<h2>Derivation<a class="headerlink" href="#derivation" title="Permalink to this headline">#</a></h2>
<p>Recall the Lagrange form of the interpolating polynomial on the nodes <span class="math notranslate nohighlight">\(x_0,x_1,\dots,x_n\)</span>:</p>
<div class="math notranslate nohighlight">
\[
p(x) = \sum_{i=0}^n y_i \ell_i(x), 
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
\ell_i(x) = \frac{\Phi(x)}{\Phi'(x_i)(x-x_i)}, \qquad \Phi(x) = \prod_{i=0}^n (x-x_i).
\]</div>
<p>We note that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
p(x) &amp; = \Phi(x) \sum_{i=0}^n \frac{y_i}{\Phi'(x_i)(x-x_i)} \\  
&amp; = \Phi(x) \sum_{i=0}^n \frac{y_iw_i}{x-x_i},
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(w_i=1/\Phi'(x_i)\)</span>. The constant function 1 is interpolated when all <span class="math notranslate nohighlight">\(y_i=1\)</span>, so</p>
<div class="math notranslate nohighlight">
\[
1 = \Phi(x) \sum_{i=0}^n \frac{w_i}{x-x_i},
\]</div>
<p>which allows us to eliminate <span class="math notranslate nohighlight">\(\Phi\)</span> and write</p>
<div class="math notranslate nohighlight">
\[
p(x) = \frac{\displaystyle \sum_{i=0}^n \frac{y_iw_i}{x-x_i}}{\displaystyle \sum_{i=0}^n \frac{w_i}{x-x_i}}. 
\]</div>
<p>This is known as the <strong>barycentric formula</strong> (historically, the <em>second</em> barycentric formula). It’s an odd-looking way to write a polynomial! But it’s been proved to be numerically stable, and it’s efficient, as well.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">#</a></h2>
<p>Here is an implementation assuming knowledge of the <strong>barycentric weights</strong> <span class="math notranslate nohighlight">\(w_j\)</span>. Evaluating <span class="math notranslate nohighlight">\(p\)</span> at one point takes only <span class="math notranslate nohighlight">\(O(n)\)</span> flops, regardless of the interpolated function values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyinterp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">eachindex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">t</span><span class="o">==</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"></span>
<span class="w">                </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">                </span><span class="n">denom</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">s</span><span class="w"> </span>
<span class="w">                </span><span class="n">numer</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">s</span><span class="w"></span>
<span class="w">            </span><span class="k">end</span><span class="w"></span>
<span class="w">        </span><span class="k">end</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">numer</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">denom</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>polyinterp (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<p>Computing the weights from the definition takes <span class="math notranslate nohighlight">\(O(n^2)\)</span> operations. Note that a uniform scaling of the weights does not affect the formula, so in practical implementations they are scaled to avoid overflow or underflow in the products.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyinterp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="n">maximum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">minimum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="n">weight</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">prod</span><span class="p">(</span><span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">eachindex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weight</span><span class="o">.</span><span class="p">(</span><span class="n">eachindex</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">polyinterp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>polyinterp (generic function with 2 methods)
</pre></div>
</div>
</div>
</div>
<p>However, the weights are known in closed form in a few cases. For equally spaced nodes in <span class="math notranslate nohighlight">\([-1,1]\)</span>, for example,</p>
<div class="math notranslate nohighlight">
\[
w_j = (-1)^j \binom{n}{j}, \qquad j=0,\ldots,n. 
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Plots</span><span class="w"></span>

<span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">3</span><span class="o">*</span><span class="n">rand</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polyinterp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"></span>
<span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;polynomial&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="o">=</span><span class="ss">:bottomleft</span><span class="p">)</span><span class="w"></span>
<span class="n">plot!</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="ss">:black</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;function&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">scatter!</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="s">&quot;data&quot;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/barycentric_5_0.svg" src="../_images/barycentric_5_0.svg" /></div>
</div>
</section>
<section id="runge-phenomenon">
<h2>Runge phenomenon<a class="headerlink" href="#runge-phenomenon" title="Permalink to this headline">#</a></h2>
<p>The barycentric formula gives us a stable way to evaluate an interpolating polynomial. However, these polynomials don’t always behave as we would like, particularly on equispaced points.</p>
<p>The Hermite error formula for polynomial interpolation includes a factor <span class="math notranslate nohighlight">\(\Phi(x)\)</span>. On equispaced node sets of length <span class="math notranslate nohighlight">\(n+1\)</span>, this behaves poorly across the interpolating interval as <span class="math notranslate nohighlight">\(n\to \infty\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">yaxis</span><span class="o">=</span><span class="p">(</span><span class="ss">:log</span><span class="p">,[</span><span class="mf">1e-25</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s">&quot;|Φ(x)|&quot;</span><span class="p">))</span><span class="w"></span>
<span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1100</span><span class="p">)</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mi">56</span><span class="w"></span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">Phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">prod</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">plot!</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">Phi</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;N=</span><span class="si">$n</span><span class="s">&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="n">plt</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/barycentric_7_0.svg" src="../_images/barycentric_7_0.svg" /></div>
</div>
<p>In the above, it’s clear that <span class="math notranslate nohighlight">\(\norm{\Phi}_\infty \to 0\)</span> as <span class="math notranslate nohighlight">\(N \to \infty\)</span>. However, there is a rapidly widening gap between <span class="math notranslate nohighlight">\(|\Phi|\)</span> near the boundary and near the center. In the next section, we will see that this gap is of size <span class="math notranslate nohighlight">\(2^N\)</span>. As it grows, it becomes impossible for machine precision to resolve all of the scales. For <span class="math notranslate nohighlight">\(O(1)\)</span> data, when the error in the middle is <span class="math notranslate nohighlight">\(O(\epsilon_{\text{mach}})\)</span>, the error at the boundaries increases beyond <span class="math notranslate nohighlight">\(O(1)\)</span> in order to maintain the gap.</p>
</section>
<section id="chebyshev-points">
<h2>Chebyshev points<a class="headerlink" href="#chebyshev-points" title="Permalink to this headline">#</a></h2>
<p>To counteract this effect, we can use interpolation nodes that are more crowded toward the boundaries. Our prime example is the <strong>Chebyshev 2nd-kind points</strong>,</p>
<div class="math notranslate nohighlight">
\[
x_j = \cos\left( \frac{j\pi}{N} \right), \qquad j = 0,\ldots,N. 
\]</div>
<p>These points are the abscissas of equally spaced points on the unit circle:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
<span class="n">plot!</span><span class="p">(</span><span class="n">cos</span><span class="p">,</span><span class="n">sin</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">π</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="n">θ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="nb">π</span><span class="o">/</span><span class="n">N</span><span class="w"></span>
<span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cis</span><span class="o">.</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"></span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">real</span><span class="p">(</span><span class="n">z</span><span class="p">),</span><span class="n">imag</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="w"></span>
<span class="n">plot!</span><span class="p">([</span><span class="n">x</span><span class="w"> </span><span class="n">x</span><span class="p">]</span><span class="o">&#39;</span><span class="p">,[</span><span class="n">zero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">]</span><span class="o">&#39;</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="p">(</span><span class="ss">:dash</span><span class="p">,</span><span class="ss">:black</span><span class="p">),</span><span class="n">m</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="ss">:black</span><span class="p">))</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/barycentric_9_0.svg" src="../_images/barycentric_9_0.svg" /></div>
</div>
<p>As we will show in the next section, these points produce a <span class="math notranslate nohighlight">\(|\Phi|\)</span> that is nearly flat across the interval:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">yaxis</span><span class="o">=</span><span class="p">(</span><span class="ss">:log</span><span class="p">,[</span><span class="mf">1e-25</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s">&quot;|Φ(x)|&quot;</span><span class="p">))</span><span class="w"></span>
<span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1100</span><span class="p">)</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mi">56</span><span class="w"></span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@.</span><span class="w"> </span><span class="n">cos</span><span class="p">((</span><span class="mi">0</span><span class="o">:</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="nb">π</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">Phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">prod</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">plot!</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">abs</span><span class="o">.</span><span class="p">(</span><span class="n">Phi</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;N=</span><span class="si">$N</span><span class="s">&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="n">plt</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/barycentric_11_0.svg" src="../_images/barycentric_11_0.svg" /></div>
</div>
<p>The poor conditioning of equispaced points in polynomial interpolation is known as the <strong>Runge phenomenon</strong>. It’s typically demonstrated on a very innocuous-looking function, <span class="math notranslate nohighlight">\(1/(1 + 16x^2)\)</span>:</p>
<section id="p9-polynomial-interpolation-in-equispaced-and-chebyshev-pts">
<h3>p9: polynomial interpolation in equispaced and Chebyshev pts<a class="headerlink" href="#p9-polynomial-interpolation-in-equispaced-and-chebyshev-pts" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">include</span><span class="p">(</span><span class="s">&quot;smij-functions.jl&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span><span class="w"></span>

<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span><span class="w"></span>
<span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="nd">@.</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;equispaced points&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="nd">@.</span><span class="w"> </span><span class="n">cospi</span><span class="p">((</span><span class="mi">0</span><span class="o">:</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Chebyshev points&quot;</span><span class="p">),</span><span class="w"></span>
<span class="p">]</span><span class="w"></span>

<span class="n">xx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.01</span><span class="o">:</span><span class="mf">0.005</span><span class="o">:</span><span class="mf">1.01</span><span class="w"></span>
<span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="n">label</span><span class="p">))</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">uu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xx</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">polyinterp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w">              </span><span class="c"># interpolation</span><span class="w"></span>
<span class="w">    </span><span class="n">pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="w">                       </span><span class="c"># evaluation of interpolant</span><span class="w"></span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">uu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pp</span><span class="p">,</span><span class="w"> </span><span class="nb">Inf</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">push!</span><span class="p">(</span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="p">(;</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">pp</span><span class="p">,</span><span class="n">error</span><span class="p">,</span><span class="n">label</span><span class="p">))</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">CairoMakie</span><span class="p">,</span><span class="w"> </span><span class="n">PyFormattedStrings</span><span class="w"></span>

<span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Figure</span><span class="p">()</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Axis</span><span class="p">(</span><span class="n">fig</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">label</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">lines!</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="o">.</span><span class="n">pp</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">scatter!</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="o">.</span><span class="n">u</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">limits!</span><span class="p">(</span><span class="o">-</span><span class="mf">1.05</span><span class="p">,</span><span class="w"> </span><span class="mf">1.05</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">text!</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s">&quot;max error = {r.error:.5g}&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="n">fig</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/barycentric_15_0.png" src="../_images/barycentric_15_0.png" />
</div>
</div>
<p>It’s also worth noting that the barycentric weights for the 2nd-kind Chebyshev points are simply</p>
<div class="math notranslate nohighlight">
\[\begin{split}
w_j = (-1)^j \cdot \begin{cases} \tfrac{1}{2}, &amp; j=0 \text{ or } j=N, \\ 1, &amp; 1 \le j \le N-1. \end{cases} 
\end{split}\]</div>
<p>We have one last form of <code class="docutils literal notranslate"><span class="pre">polyinterp</span></code> that assumes the function values are given at the Chebyshev points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="n">polyinterp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="nb">π</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="n">N</span><span class="w"> </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">float</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="n">N</span><span class="w"> </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="n">w</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="k">end</span><span class="p">]]</span><span class="w"> </span><span class="o">.*=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">polyinterp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>polyinterp (generic function with 3 methods)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "tobydriscoll/fd-spectral-notes",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.8"
        },
        kernelOptions: {
            kernelName: "julia-1.8",
            path: "./smim"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.8'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="smoothness.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6.4. </span>Convergence rates</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="potential.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.6. </span>Potential theory</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Tobin A. Driscoll<br/>
  
      &copy; Copyright 2022.<br/>
    <div class="extra_footer">
      <img alt='UD logo' src='_static/UDlogo-small.png'>
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>